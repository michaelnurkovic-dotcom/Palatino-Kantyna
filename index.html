<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#C9A55A">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Palatino Kantýna</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBLQSuo5Fq8xHj0Mvpw3qeZHtiAkfmJWpU",
            authDomain: "kantyna-palatino.firebaseapp.com",
            projectId: "kantyna-palatino",
            storageBucket: "kantyna-palatino.firebasestorage.app",
            messagingSenderId: "529447592074",
            appId: "1:529447592074:web:479beecad7e386d86bcd73",
            measurementId: "G-8MBP6T6DWL"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
    </script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&family=Montserrat:wght@200;300;400;500;600&display=swap');
        
        :root {
            --gold: #C9A55A;
            --gold-light: #E8D5A3;
            --gold-dark: #A88B3D;
            --cream: #FDF8F0;
            --charcoal: #2A2A2A;
            --white: #FFFFFF;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Montserrat', sans-serif;
            background: var(--cream);
            color: var(--charcoal);
            overscroll-behavior: none;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* Ocean Waves Pattern - Aerial View with Foam */
        .wave-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }
        
        .wave-pattern svg {
            position: absolute;
            width: 120%;
            height: 120%;
            top: -10%;
            left: -10%;
        }
        
        /* Main wave movement */
        .wave-main {
            animation: waveRoll 15s ease-in-out infinite;
        }
        
        .wave-main-2 {
            animation: waveRoll 18s ease-in-out infinite reverse;
            animation-delay: -5s;
        }
        
        .wave-main-3 {
            animation: waveRoll 20s ease-in-out infinite;
            animation-delay: -10s;
        }
        
        @keyframes waveRoll {
            0%, 100% { 
                transform: translateX(0) translateY(0);
            }
            25% {
                transform: translateX(2%) translateY(-1%);
            }
            50% { 
                transform: translateX(3%) translateY(-2%);
            }
            75% {
                transform: translateX(1%) translateY(-1%);
            }
        }
        
        /* Foam particles floating */
        .foam-group {
            animation: foamFloat 12s ease-in-out infinite;
        }
        
        .foam-group-2 {
            animation: foamFloat 15s ease-in-out infinite;
            animation-delay: -4s;
        }
        
        .foam-group-3 {
            animation: foamFloat 18s ease-in-out infinite;
            animation-delay: -8s;
        }
        
        @keyframes foamFloat {
            0%, 100% { 
                transform: translate(0, 0) scale(1);
                opacity: 0.6;
            }
            33% {
                transform: translate(1%, -0.5%) scale(1.02);
                opacity: 0.7;
            }
            66% { 
                transform: translate(2%, 0.5%) scale(0.98);
                opacity: 0.5;
            }
        }
        
        /* Subtle grain texture overlay */
        .grain-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            opacity: 0.02;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
        }
        
        /* Typography */
        h1, h2, h3 {
            font-family: 'Cormorant Garamond', serif;
        }
        
        /* Elegant Button Styles */
        .btn-gold {
            background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%);
            color: var(--white);
            border: none;
            padding: 16px 32px;
            font-family: 'Montserrat', sans-serif;
            font-weight: 500;
            font-size: 12px;
            letter-spacing: 3px;
            text-transform: uppercase;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .btn-gold::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }
        
        .btn-gold:hover::before {
            left: 100%;
        }
        
        .btn-gold:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(201, 165, 90, 0.4);
        }
        
        .btn-gold:active {
            transform: translateY(0);
        }
        
        .btn-outline {
            background: transparent;
            color: var(--gold);
            border: 1px solid var(--gold);
            padding: 12px 24px;
            font-family: 'Montserrat', sans-serif;
            font-weight: 500;
            font-size: 11px;
            letter-spacing: 2px;
            text-transform: uppercase;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .btn-outline::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 0;
            background: var(--gold);
            transition: height 0.3s ease;
            z-index: -1;
        }
        
        .btn-outline:hover {
            color: var(--white);
        }
        
        .btn-outline:hover::after {
            height: 100%;
        }
        
        /* Card Styles */
        .card {
            background: var(--white);
            border: 1px solid rgba(201, 165, 90, 0.2);
            position: relative;
            overflow: hidden;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 0;
            background: linear-gradient(180deg, var(--gold) 0%, var(--gold-light) 100%);
            transition: height 0.4s ease;
        }
        
        .card:hover::before {
            height: 100%;
        }
        
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 60px rgba(201, 165, 90, 0.15);
            border-color: var(--gold);
        }
        
        /* Decorative Elements */
        .ornament {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 16px;
            margin: 20px 0;
        }
        
        .ornament-line {
            height: 1px;
            width: 60px;
            background: linear-gradient(90deg, transparent, var(--gold), transparent);
        }
        
        .ornament-diamond {
            width: 8px;
            height: 8px;
            background: var(--gold);
            transform: rotate(45deg);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 0.5; transform: rotate(45deg) scale(1); }
            50% { opacity: 1; transform: rotate(45deg) scale(1.2); }
        }
        
        /* Input Styles */
        .input-elegant {
            width: 100%;
            padding: 16px 20px;
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            font-weight: 300;
            border: 1px solid rgba(201, 165, 90, 0.3);
            background: var(--white);
            color: var(--charcoal);
            transition: all 0.3s ease;
            outline: none;
        }
        
        .input-elegant:focus {
            border-color: var(--gold);
            box-shadow: 0 0 0 3px rgba(201, 165, 90, 0.1);
        }
        
        .input-elegant::placeholder {
            color: #999;
            font-weight: 300;
        }
        
        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes slideUp {
            from {
                transform: translateY(100%);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        @keyframes borderGlow {
            0%, 100% { box-shadow: 0 0 0 0 rgba(201, 165, 90, 0); }
            50% { box-shadow: 0 0 20px 5px rgba(201, 165, 90, 0.2); }
        }
        
        .animate-fadeInUp {
            animation: fadeInUp 0.6s ease-out forwards;
        }
        
        .animate-fadeInScale {
            animation: fadeInScale 0.5s ease-out forwards;
        }
        
        .animate-slideUp {
            animation: slideUp 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }
        
        /* Staggered animations */
        .stagger-1 { animation-delay: 0.1s; opacity: 0; }
        .stagger-2 { animation-delay: 0.2s; opacity: 0; }
        .stagger-3 { animation-delay: 0.3s; opacity: 0; }
        .stagger-4 { animation-delay: 0.4s; opacity: 0; }
        .stagger-5 { animation-delay: 0.5s; opacity: 0; }
        
        /* Counter Animation */
        .counter-badge {
            position: relative;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 24px;
            height: 24px;
            background: var(--gold);
            color: var(--white);
            font-size: 11px;
            font-weight: 600;
            border-radius: 12px;
            animation: popIn 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        @keyframes popIn {
            0% { transform: scale(0); }
            100% { transform: scale(1); }
        }
        
        /* Quantity Controls */
        .qty-controls {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px;
            border: 1px solid var(--gold);
            background: rgba(201, 165, 90, 0.05);
        }
        
        .qty-btn {
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--white);
            border: 1px solid var(--gold);
            color: var(--gold);
            font-size: 20px;
            font-weight: 300;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .qty-btn:hover {
            background: var(--gold);
            color: var(--white);
        }
        
        .qty-btn:active {
            transform: scale(0.95);
        }
        
        /* Day Selector Pills */
        .day-pill {
            padding: 10px 16px;
            font-size: 11px;
            font-weight: 500;
            letter-spacing: 1px;
            border: 1px solid var(--gold);
            background: transparent;
            color: var(--gold);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .day-pill.active {
            background: var(--gold);
            color: var(--white);
        }
        
        .day-pill:not(.active):hover {
            background: rgba(201, 165, 90, 0.1);
        }
        
        /* Price Tag */
        .price-tag {
            font-family: 'Montserrat', sans-serif;
            font-size: 26px;
            font-weight: 300;
            color: var(--gold);
            position: relative;
            letter-spacing: 1px;
        }
        
        .price-tag::after {
            content: ' Kč';
            font-size: 13px;
            font-weight: 400;
            opacity: 0.8;
        }
        
        /* Category Divider */
        .category-header {
            text-align: center;
            padding: 40px 20px 30px;
            position: relative;
        }
        
        .category-title {
            font-family: 'Cormorant Garamond', serif;
            font-size: 28px;
            font-weight: 500;
            color: var(--gold);
            letter-spacing: 8px;
            text-transform: uppercase;
            position: relative;
            display: inline-block;
        }
        
        .category-title::before,
        .category-title::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 40px;
            height: 1px;
            background: var(--gold);
        }
        
        .category-title::before {
            right: calc(100% + 20px);
        }
        
        .category-title::after {
            left: calc(100% + 20px);
        }
        
        /* Confirmation Screen */
        .confirm-pin {
            font-family: 'Montserrat', sans-serif;
            font-size: 64px;
            font-weight: 200;
            color: var(--gold);
            letter-spacing: 8px;
            animation: fadeInScale 0.8s ease-out;
        }
        
        .confirm-check {
            width: 80px;
            height: 80px;
            border: 2px solid var(--gold);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 24px;
            animation: borderGlow 2s infinite;
        }
        
        .confirm-check svg {
            width: 40px;
            height: 40px;
            stroke: var(--gold);
            stroke-width: 2;
            animation: drawCheck 0.6s ease-out 0.3s forwards;
            stroke-dasharray: 50;
            stroke-dashoffset: 50;
        }
        
        @keyframes drawCheck {
            to { stroke-dashoffset: 0; }
        }
        
        /* Cart Panel */
        .cart-panel {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--white);
            border-top: 2px solid var(--gold);
            box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.1);
            z-index: 100;
            animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .cart-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 3px;
            background: var(--gold);
            opacity: 0.5;
        }
        
        /* Header Glass Effect */
        .header-glass {
            background: rgba(253, 248, 240, 0.95);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(201, 165, 90, 0.3);
        }
        
        /* Scroll indicator */
        .scroll-indicator {
            position: fixed;
            top: 0;
            left: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--gold), var(--gold-light));
            z-index: 1000;
            transition: width 0.1s ease;
        }
        
        /* Loading Shimmer */
        .shimmer {
            background: linear-gradient(90deg, 
                rgba(201, 165, 90, 0.1) 25%, 
                rgba(201, 165, 90, 0.2) 50%, 
                rgba(201, 165, 90, 0.1) 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        
        /* Responsive */
        @media (max-width: 640px) {
            .category-title::before,
            .category-title::after {
                width: 20px;
            }
            
            .category-title::before {
                right: calc(100% + 10px);
            }
            
            .category-title::after {
                left: calc(100% + 10px);
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Firebase databáze
        const DB = {
            getMenu: (manualDay = null) => {
                const dayOfWeek = manualDay !== null ? manualDay : new Date().getDay();
                
                const dailyMenus = {
                    1: [
                        { id: 1, name: 'Fazolová polévka se sýrem feta', price: 49, category: 'Polévka', available: true },
                        { id: 2, name: 'Kuře na paprice s těstovinami', price: 169, category: 'Hlavní jídlo', available: true },
                        { id: 3, name: 'Vepřová panenka pečená ve slanině', price: 199, category: 'Hlavní jídlo', available: true },
                        { id: 4, name: 'Trhané vepřové maso s cheddarem a jalapeños', price: 179, category: 'Hlavní jídlo', available: true },
                        { id: 5, name: 'Hříbkové rizoto s kuřecím masem', price: 179, category: 'Hlavní jídlo', available: true },
                        { id: 6, name: 'Penne alla arabiata', price: 169, category: 'Hlavní jídlo', available: true },
                        { id: 7, name: 'Pizza con prosciutto cotto formagio Ø 29cm', price: 189, category: 'Hlavní jídlo', available: true },
                        { id: 8, name: 'Salámová pizza Ø 29cm', price: 179, category: 'Hlavní jídlo', available: true },
                        { id: 9, name: 'Linguine carbonara', price: 198, category: 'Hlavní jídlo', available: true },
                        { id: 10, name: 'Šunková pizza Ø 29cm', price: 179, category: 'Hlavní jídlo', available: true }
                    ],
                    2: [
                        { id: 1, name: 'Hovězí vývar s játrovými knedlíčky', price: 59, category: 'Polévka', available: true },
                        { id: 2, name: 'Španělský ptáček', price: 199, category: 'Hlavní jídlo', available: true },
                        { id: 3, name: 'Halušky s uzeným masem, bílé zelí', price: 169, category: 'Hlavní jídlo', available: true },
                        { id: 4, name: 'Wrap s trhaným vepřovým masem', price: 179, category: 'Hlavní jídlo', available: true },
                        { id: 5, name: 'Salát s kuřecím masem a těstovinami', price: 189, category: 'Hlavní jídlo', available: true },
                        { id: 6, name: 'Pizza se šunkou a salámem Ø 29cm', price: 179, category: 'Hlavní jídlo', available: true },
                        { id: 7, name: 'Cheese burger', price: 189, category: 'Hlavní jídlo', available: true },
                        { id: 8, name: 'Hranolky', price: 59, category: 'Příloha', available: true },
                        { id: 9, name: 'Pinsa mexicana Ø 29cm', price: 208, category: 'Hlavní jídlo', available: true },
                        { id: 10, name: 'Gnocchi potenza', price: 189, category: 'Hlavní jídlo', available: true },
                        { id: 11, name: 'Penne bolognese', price: 178, category: 'Hlavní jídlo', available: true }
                    ],
                    3: [
                        { id: 1, name: 'Tomatová polévka se sýrem', price: 59, category: 'Polévka', available: true },
                        { id: 2, name: 'Hovězí guláš', price: 189, category: 'Hlavní jídlo', available: true },
                        { id: 3, name: 'Kuřecí řízek s vídeňským bramborovým salátem', price: 189, category: 'Hlavní jídlo', available: true },
                        { id: 4, name: 'Linguine s vepřovou panenkou', price: 189, category: 'Hlavní jídlo', available: true },
                        { id: 5, name: 'Salámová pizza Ø 29 cm', price: 179, category: 'Hlavní jídlo', available: true },
                        { id: 6, name: 'Linguine la crema', price: 189, category: 'Hlavní jídlo', available: true },
                        { id: 7, name: 'Pizza Hawaii Ø 29 cm', price: 179, category: 'Hlavní jídlo', available: true },
                        { id: 8, name: 'Linguine s lososem', price: 199, category: 'Hlavní jídlo', available: true },
                        { id: 9, name: 'Houbovo smetanová pinsa Ø 32 cm', price: 208, category: 'Hlavní jídlo', available: true },
                        { id: 10, name: 'Lasagne s kuřecím masem a špenátem', price: 239, category: 'Hlavní jídlo', available: true }
                    ],
                    4: [
                        { id: 1, name: 'Bramboračka', price: 49, category: 'Polévka', available: true },
                        { id: 2, name: 'Hovězí ragú po Burgundsku', price: 199, category: 'Hlavní jídlo', available: true },
                        { id: 3, name: 'Kuřecí steak s tyrolskou šunkou', price: 189, category: 'Hlavní jídlo', available: true },
                        { id: 4, name: 'Wrap s kuřecími stripsy', price: 179, category: 'Hlavní jídlo', available: true },
                        { id: 5, name: 'Šunková pizza Ø 29 cm', price: 179, category: 'Hlavní jídlo', available: true },
                        { id: 6, name: 'Pizza carbonara Ø 29 cm', price: 179, category: 'Hlavní jídlo', available: true },
                        { id: 7, name: 'Bramborové noky s kuřecím masem v sýrové omáčce', price: 189, category: 'Hlavní jídlo', available: true },
                        { id: 8, name: 'Penne s vepřovou panenkou a špenátem', price: 188, category: 'Hlavní jídlo', available: true },
                        { id: 9, name: 'Pinsa s kuřecím masem a BBQ omáčkou Ø 32 cm', price: 218, category: 'Hlavní jídlo', available: true },
                        { id: 10, name: 'Linguine aglio olio peperoncino', price: 158, category: 'Hlavní jídlo', available: true }
                    ],
                    5: [
                        { id: 1, name: 'Špenátový krém se sýrovými krutony', price: 59, category: 'Polévka', available: true },
                        { id: 2, name: 'Kuřecí specatino se šťouchanými brambory', price: 189, category: 'Hlavní jídlo', available: true },
                        { id: 3, name: 'Obalovaný sýr Gouda', price: 179, category: 'Hlavní jídlo', available: true },
                        { id: 4, name: 'Salát s kuřecím masem', price: 179, category: 'Hlavní jídlo', available: true },
                        { id: 5, name: 'Pizza se šunkou a salámem Ø 29 cm', price: 179, category: 'Hlavní jídlo', available: true },
                        { id: 6, name: 'Pizza margharita Ø 29 cm', price: 169, category: 'Hlavní jídlo', available: true },
                        { id: 7, name: 'Rizoto s krůtím masem', price: 189, category: 'Hlavní jídlo', available: true },
                        { id: 8, name: 'Penne s kuřecím masem a špenátem', price: 198, category: 'Hlavní jídlo', available: true },
                        { id: 9, name: 'Šunková pizza Ø 29 cm', price: 179, category: 'Hlavní jídlo', available: true },
                        { id: 10, name: 'Kuřecí stripsy obalené v cornflakes', price: 169, category: 'Hlavní jídlo', available: true }
                    ]
                };
                
                if (dayOfWeek >= 1 && dayOfWeek <= 5) {
                    return dailyMenus[dayOfWeek];
                } else {
                    return [
                        { id: 1, name: 'O víkendu nemáme polední menu', price: 0, category: 'Info', available: false }
                    ];
                }
            },
            saveMenu: (menu) => {},
            getOrders: async (callback) => {
                const today = new Date().toISOString().split('T')[0];
                const baseQuery = db.collection('orders').where('date', '==', today);
                try {
                    baseQuery
                        .orderBy('createdAt', 'desc')
                        .onSnapshot((snapshot) => {
                            const orders = [];
                            snapshot.forEach((doc) => {
                                orders.push({ ...doc.data(), id: doc.id });
                            });
                            callback(orders);
                        }, (err) => {
                            console.error('onSnapshot error (orderBy createdAt):', err);
                            // Fallback bez orderBy (např. chybějící index). Seřadíme klientsky.
                            baseQuery.onSnapshot((snapshot2) => {
                                const orders2 = [];
                                snapshot2.forEach((doc) => {
                                    orders2.push({ ...doc.data(), id: doc.id });
                                });
                                orders2.sort((a,b) => {
                                    const ta = a.createdAt && a.createdAt.toMillis ? a.createdAt.toMillis() : (new Date(a.createdAt).getTime() || 0);
                                    const tb = b.createdAt && b.createdAt.toMillis ? b.createdAt.toMillis() : (new Date(b.createdAt).getTime() || 0);
                                    return tb - ta;
                                });
                                callback(orders2);
                            });
                        });
                } catch(e) {
                    console.error('getOrders setup failed:', e);
                    baseQuery.onSnapshot((snapshot3) => {
                        const orders3 = [];
                        snapshot3.forEach((doc) => {
                            orders3.push({ ...doc.data(), id: doc.id });
                        });
                        callback(orders3);
                    });
                }
            },
            saveOrder: async (order) => {
                const today = new Date().toISOString().split('T')[0];
                const orderData = {
                    ...order,
                    date: today,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                };
                await db.collection('orders').add(orderData);
                return order;
            },
            updateOrder: async (orderId, updates) => {
                await db.collection('orders').doc(orderId).update(updates);
            },
            deleteOrder: async (orderId) => {
                await db.collection('orders').doc(orderId).delete();
            }
        };

        // Animated Ocean Waves Background - Aerial View with Realistic Foam
        function AnimatedBackground() {
            return (
                <>
                    <div className="wave-pattern">
                        <svg viewBox="0 0 1000 1000" preserveAspectRatio="xMidYMid slice">
                            <defs>
                                {/* Water body gradient */}
                                <linearGradient id="waterBody" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" stopColor="#C9A55A" stopOpacity="0.1"/>
                                    <stop offset="100%" stopColor="#A88B3D" stopOpacity="0.05"/>
                                </linearGradient>
                                
                                {/* Foam gradient - bright center fading out */}
                                <radialGradient id="foamBubble" cx="50%" cy="50%" r="50%">
                                    <stop offset="0%" stopColor="#FAF6ED" stopOpacity="0.7"/>
                                    <stop offset="40%" stopColor="#F0E6D2" stopOpacity="0.5"/>
                                    <stop offset="70%" stopColor="#E8D5A3" stopOpacity="0.3"/>
                                    <stop offset="100%" stopColor="#C9A55A" stopOpacity="0"/>
                                </radialGradient>
                                
                                {/* Smaller foam spots */}
                                <radialGradient id="foamSmall" cx="50%" cy="50%" r="50%">
                                    <stop offset="0%" stopColor="#FBF8F1" stopOpacity="0.6"/>
                                    <stop offset="60%" stopColor="#E8D5A3" stopOpacity="0.25"/>
                                    <stop offset="100%" stopColor="#C9A55A" stopOpacity="0"/>
                                </radialGradient>
                                
                                {/* Filters */}
                                <filter id="softBlur">
                                    <feGaussianBlur in="SourceGraphic" stdDeviation="2" />
                                </filter>
                                <filter id="gentleBlur">
                                    <feGaussianBlur in="SourceGraphic" stdDeviation="4" />
                                </filter>
                            </defs>
                            
                            {/* ===== WAVE 1 - Top ===== */}
                            <g className="wave-main">
                                {/* Wave body */}
                                <path d="M-100,250 
                                    C50,200 150,300 350,240 
                                    C550,180 650,320 850,230 
                                    C950,185 1050,260 1150,210
                                    L1150,400 
                                    C1000,360 900,440 700,380 
                                    C500,320 400,420 200,360 
                                    C0,300 -50,380 -100,340 Z" 
                                    fill="url(#waterBody)"/>
                                
                                {/* Foam crest - cluster of organic shapes */}
                                <g filter="url(#softBlur)">
                                    {/* Main foam line - irregular blobs */}
                                    <ellipse cx="50" cy="230" rx="35" ry="12" fill="url(#foamBubble)" transform="rotate(-5 50 230)"/>
                                    <ellipse cx="120" cy="245" rx="28" ry="10" fill="url(#foamBubble)" transform="rotate(8 120 245)"/>
                                    <ellipse cx="180" cy="260" rx="40" ry="14" fill="url(#foamBubble)" transform="rotate(-3 180 260)"/>
                                    <ellipse cx="250" cy="250" rx="32" ry="11" fill="url(#foamBubble)" transform="rotate(12 250 250)"/>
                                    <ellipse cx="320" cy="235" rx="38" ry="13" fill="url(#foamBubble)" transform="rotate(-8 320 235)"/>
                                    <ellipse cx="400" cy="220" rx="30" ry="10" fill="url(#foamBubble)" transform="rotate(5 400 220)"/>
                                    <ellipse cx="470" cy="235" rx="42" ry="15" fill="url(#foamBubble)" transform="rotate(-10 470 235)"/>
                                    <ellipse cx="550" cy="210" rx="35" ry="12" fill="url(#foamBubble)" transform="rotate(7 550 210)"/>
                                    <ellipse cx="620" cy="240" rx="28" ry="9" fill="url(#foamBubble)" transform="rotate(-4 620 240)"/>
                                    <ellipse cx="700" cy="220" rx="38" ry="14" fill="url(#foamBubble)" transform="rotate(10 700 220)"/>
                                    <ellipse cx="780" cy="245" rx="32" ry="11" fill="url(#foamBubble)" transform="rotate(-6 780 245)"/>
                                    <ellipse cx="850" cy="225" rx="36" ry="13" fill="url(#foamBubble)" transform="rotate(3 850 225)"/>
                                    <ellipse cx="930" cy="210" rx="30" ry="10" fill="url(#foamBubble)" transform="rotate(-9 930 210)"/>
                                    <ellipse cx="1000" cy="230" rx="40" ry="14" fill="url(#foamBubble)" transform="rotate(6 1000 230)"/>
                                    
                                    {/* Secondary smaller foam */}
                                    <ellipse cx="85" cy="255" rx="18" ry="7" fill="url(#foamSmall)" transform="rotate(15 85 255)"/>
                                    <ellipse cx="210" cy="275" rx="22" ry="8" fill="url(#foamSmall)" transform="rotate(-12 210 275)"/>
                                    <ellipse cx="360" cy="250" rx="20" ry="7" fill="url(#foamSmall)" transform="rotate(8 360 250)"/>
                                    <ellipse cx="510" cy="245" rx="24" ry="9" fill="url(#foamSmall)" transform="rotate(-5 510 245)"/>
                                    <ellipse cx="660" cy="255" rx="18" ry="6" fill="url(#foamSmall)" transform="rotate(11 660 255)"/>
                                    <ellipse cx="820" cy="260" rx="22" ry="8" fill="url(#foamSmall)" transform="rotate(-7 820 260)"/>
                                    <ellipse cx="960" cy="245" rx="20" ry="7" fill="url(#foamSmall)" transform="rotate(4 960 245)"/>
                                </g>
                            </g>
                            
                            {/* ===== WAVE 2 - Middle ===== */}
                            <g className="wave-main-2">
                                <path d="M-100,500 
                                    C100,440 200,560 420,480 
                                    C640,400 740,550 950,460 
                                    C1050,420 1100,500 1150,450
                                    L1150,650 
                                    C1050,610 950,700 750,630 
                                    C550,560 450,680 250,600 
                                    C50,520 -50,620 -100,570 Z" 
                                    fill="url(#waterBody)" fillOpacity="0.8"/>
                                
                                <g filter="url(#softBlur)">
                                    <ellipse cx="30" cy="480" rx="32" ry="11" fill="url(#foamBubble)" transform="rotate(-7 30 480)"/>
                                    <ellipse cx="110" cy="465" rx="38" ry="13" fill="url(#foamBubble)" transform="rotate(5 110 465)"/>
                                    <ellipse cx="200" cy="490" rx="30" ry="10" fill="url(#foamBubble)" transform="rotate(-10 200 490)"/>
                                    <ellipse cx="280" cy="475" rx="42" ry="15" fill="url(#foamBubble)" transform="rotate(8 280 475)"/>
                                    <ellipse cx="370" cy="455" rx="35" ry="12" fill="url(#foamBubble)" transform="rotate(-4 370 455)"/>
                                    <ellipse cx="460" cy="480" rx="28" ry="10" fill="url(#foamBubble)" transform="rotate(12 460 480)"/>
                                    <ellipse cx="550" cy="450" rx="40" ry="14" fill="url(#foamBubble)" transform="rotate(-6 550 450)"/>
                                    <ellipse cx="640" cy="475" rx="33" ry="11" fill="url(#foamBubble)" transform="rotate(3 640 475)"/>
                                    <ellipse cx="730" cy="445" rx="36" ry="13" fill="url(#foamBubble)" transform="rotate(-9 730 445)"/>
                                    <ellipse cx="820" cy="470" rx="30" ry="10" fill="url(#foamBubble)" transform="rotate(7 820 470)"/>
                                    <ellipse cx="900" cy="450" rx="38" ry="14" fill="url(#foamBubble)" transform="rotate(-3 900 450)"/>
                                    <ellipse cx="980" cy="465" rx="34" ry="12" fill="url(#foamBubble)" transform="rotate(10 980 465)"/>
                                    
                                    <ellipse cx="70" cy="500" rx="20" ry="7" fill="url(#foamSmall)" transform="rotate(14 70 500)"/>
                                    <ellipse cx="240" cy="505" rx="24" ry="8" fill="url(#foamSmall)" transform="rotate(-8 240 505)"/>
                                    <ellipse cx="420" cy="490" rx="18" ry="6" fill="url(#foamSmall)" transform="rotate(6 420 490)"/>
                                    <ellipse cx="590" cy="485" rx="22" ry="8" fill="url(#foamSmall)" transform="rotate(-11 590 485)"/>
                                    <ellipse cx="770" cy="480" rx="20" ry="7" fill="url(#foamSmall)" transform="rotate(9 770 480)"/>
                                    <ellipse cx="940" cy="485" rx="18" ry="6" fill="url(#foamSmall)" transform="rotate(-5 940 485)"/>
                                </g>
                            </g>
                            
                            {/* ===== WAVE 3 - Bottom ===== */}
                            <g className="wave-main-3">
                                <path d="M-100,730 
                                    C80,670 180,780 380,700 
                                    C580,620 680,770 880,680 
                                    C980,640 1060,720 1150,670
                                    L1150,880 
                                    C1040,840 940,930 740,860 
                                    C540,790 440,900 240,820 
                                    C40,740 -40,840 -100,790 Z" 
                                    fill="url(#waterBody)" fillOpacity="0.6"/>
                                
                                <g filter="url(#softBlur)">
                                    <ellipse cx="20" cy="710" rx="30" ry="10" fill="url(#foamBubble)" transform="rotate(-6 20 710)"/>
                                    <ellipse cx="100" cy="695" rx="36" ry="12" fill="url(#foamBubble)" transform="rotate(9 100 695)"/>
                                    <ellipse cx="190" cy="720" rx="28" ry="9" fill="url(#foamBubble)" transform="rotate(-4 190 720)"/>
                                    <ellipse cx="280" cy="700" rx="40" ry="14" fill="url(#foamBubble)" transform="rotate(7 280 700)"/>
                                    <ellipse cx="370" cy="680" rx="32" ry="11" fill="url(#foamBubble)" transform="rotate(-10 370 680)"/>
                                    <ellipse cx="460" cy="705" rx="35" ry="12" fill="url(#foamBubble)" transform="rotate(5 460 705)"/>
                                    <ellipse cx="550" cy="675" rx="38" ry="13" fill="url(#foamBubble)" transform="rotate(-8 550 675)"/>
                                    <ellipse cx="640" cy="700" rx="30" ry="10" fill="url(#foamBubble)" transform="rotate(11 640 700)"/>
                                    <ellipse cx="730" cy="670" rx="34" ry="12" fill="url(#foamBubble)" transform="rotate(-3 730 670)"/>
                                    <ellipse cx="820" cy="695" rx="36" ry="13" fill="url(#foamBubble)" transform="rotate(6 820 695)"/>
                                    <ellipse cx="910" cy="665" rx="32" ry="11" fill="url(#foamBubble)" transform="rotate(-9 910 665)"/>
                                    <ellipse cx="1000" cy="685" rx="38" ry="13" fill="url(#foamBubble)" transform="rotate(4 1000 685)"/>
                                    
                                    <ellipse cx="60" cy="730" rx="18" ry="6" fill="url(#foamSmall)" transform="rotate(12 60 730)"/>
                                    <ellipse cx="230" cy="735" rx="22" ry="7" fill="url(#foamSmall)" transform="rotate(-7 230 735)"/>
                                    <ellipse cx="410" cy="720" rx="20" ry="7" fill="url(#foamSmall)" transform="rotate(8 410 720)"/>
                                    <ellipse cx="600" cy="715" rx="18" ry="6" fill="url(#foamSmall)" transform="rotate(-10 600 715)"/>
                                    <ellipse cx="780" cy="710" rx="22" ry="8" fill="url(#foamSmall)" transform="rotate(5 780 710)"/>
                                    <ellipse cx="950" cy="700" rx="20" ry="7" fill="url(#foamSmall)" transform="rotate(-6 950 700)"/>
                                </g>
                            </g>
                            
                            {/* ===== Scattered foam in water ===== */}
                            <g filter="url(#gentleBlur)" className="foam-group">
                                <ellipse cx="150" cy="350" rx="25" ry="10" fill="url(#foamSmall)" opacity="0.4" transform="rotate(20 150 350)"/>
                                <ellipse cx="400" cy="380" rx="30" ry="12" fill="url(#foamSmall)" opacity="0.35" transform="rotate(-15 400 380)"/>
                                <ellipse cx="650" cy="340" rx="22" ry="8" fill="url(#foamSmall)" opacity="0.4" transform="rotate(10 650 340)"/>
                                <ellipse cx="850" cy="370" rx="28" ry="10" fill="url(#foamSmall)" opacity="0.35" transform="rotate(-8 850 370)"/>
                                
                                <ellipse cx="100" cy="600" rx="24" ry="9" fill="url(#foamSmall)" opacity="0.3" transform="rotate(18 100 600)"/>
                                <ellipse cx="320" cy="630" rx="28" ry="11" fill="url(#foamSmall)" opacity="0.35" transform="rotate(-12 320 630)"/>
                                <ellipse cx="550" cy="590" rx="20" ry="7" fill="url(#foamSmall)" opacity="0.3" transform="rotate(6 550 590)"/>
                                <ellipse cx="780" cy="620" rx="26" ry="10" fill="url(#foamSmall)" opacity="0.35" transform="rotate(-20 780 620)"/>
                                
                                <ellipse cx="200" cy="850" rx="22" ry="8" fill="url(#foamSmall)" opacity="0.25" transform="rotate(14 200 850)"/>
                                <ellipse cx="450" cy="880" rx="26" ry="10" fill="url(#foamSmall)" opacity="0.3" transform="rotate(-10 450 880)"/>
                                <ellipse cx="700" cy="840" rx="20" ry="7" fill="url(#foamSmall)" opacity="0.25" transform="rotate(8 700 840)"/>
                                <ellipse cx="900" cy="870" rx="24" ry="9" fill="url(#foamSmall)" opacity="0.3" transform="rotate(-16 900 870)"/>
                            </g>
                            
                            {/* Tiny scattered foam spots */}
                            <g filter="url(#gentleBlur)" className="foam-group-2">
                                <circle cx="80" cy="320" r="8" fill="#F0E6D2" opacity="0.2"/>
                                <circle cx="250" cy="360" r="6" fill="#F0E6D2" opacity="0.15"/>
                                <circle cx="500" cy="330" r="9" fill="#F0E6D2" opacity="0.2"/>
                                <circle cx="720" cy="360" r="7" fill="#F0E6D2" opacity="0.15"/>
                                <circle cx="950" cy="340" r="8" fill="#F0E6D2" opacity="0.2"/>
                                
                                <circle cx="180" cy="560" r="7" fill="#F0E6D2" opacity="0.15"/>
                                <circle cx="420" cy="580" r="9" fill="#F0E6D2" opacity="0.2"/>
                                <circle cx="680" cy="550" r="6" fill="#F0E6D2" opacity="0.15"/>
                                <circle cx="880" cy="570" r="8" fill="#F0E6D2" opacity="0.2"/>
                                
                                <circle cx="120" cy="800" r="6" fill="#F0E6D2" opacity="0.12"/>
                                <circle cx="350" cy="820" r="8" fill="#F0E6D2" opacity="0.15"/>
                                <circle cx="600" cy="790" r="7" fill="#F0E6D2" opacity="0.12"/>
                                <circle cx="820" cy="810" r="9" fill="#F0E6D2" opacity="0.15"/>
                            </g>
                            
                            {/* Distant wave hint */}
                            <g className="wave-main" style={{ opacity: 0.35 }}>
                                <path d="M-100,60 
                                    C100,20 200,100 400,50 
                                    C600,0 700,90 900,40 
                                    C1000,10 1080,70 1150,30
                                    L1150,120 
                                    C1050,90 950,150 750,100 
                                    C550,50 450,130 250,80 
                                    C50,30 -50,100 -100,60 Z" 
                                    fill="url(#waterBody)"/>
                                    
                                <g filter="url(#softBlur)" opacity="0.6">
                                    <ellipse cx="100" cy="50" rx="25" ry="8" fill="url(#foamBubble)"/>
                                    <ellipse cx="300" cy="60" rx="30" ry="10" fill="url(#foamBubble)"/>
                                    <ellipse cx="500" cy="40" rx="28" ry="9" fill="url(#foamBubble)"/>
                                    <ellipse cx="700" cy="55" rx="32" ry="11" fill="url(#foamBubble)"/>
                                    <ellipse cx="900" cy="35" rx="26" ry="8" fill="url(#foamBubble)"/>
                                </g>
                            </g>
                        </svg>
                    </div>
                    
                    {/* Grain Overlay */}
                    <div className="grain-overlay" />
                </>
            );
        }

        // Scroll Progress Indicator
        function ScrollProgress() {
            const [progress, setProgress] = useState(0);
            
            useEffect(() => {
                const handleScroll = () => {
                    const scrollHeight = document.documentElement.scrollHeight - window.innerHeight;
                    const scrollTop = window.scrollY;
                    setProgress((scrollTop / scrollHeight) * 100);
                };
                
                window.addEventListener('scroll', handleScroll);
                return () => window.removeEventListener('scroll', handleScroll);
            }, []);
            
            return <div className="scroll-indicator" style={{ width: `${progress}%` }} />;
        }

        // Ornament Divider Component
        function Ornament() {
            return (
                <div className="ornament">
                    <div className="ornament-line" />
                    <div className="ornament-diamond" />
                    <div className="ornament-line" />
                </div>
            );
        }

        // Main App
        function App() {
            const [view, setView] = useState('customer');
            const [isAdminAuth, setIsAdminAuth] = useState(false);
            const [manualDay, setManualDay] = useState(null);

            return (
                <div style={{ minHeight: '100vh', position: 'relative' }}>
                    
                    <div style={{ position: 'relative', zIndex: 2 }}>
                        {view === 'customer' ? (
                            <CustomerView 
                                onAdminClick={() => setView('admin')} 
                                manualDay={manualDay}
                                setManualDay={setManualDay}
                            />
                        ) : (
                            <AdminView 
                                isAuth={isAdminAuth} 
                                onAuth={setIsAdminAuth}
                                onBack={() => setView('customer')} 
                            />
                        )}
                    </div>
                </div>
            );
        }

        // Customer View
        function CustomerView({ onAdminClick, manualDay, setManualDay }) {
            const [step, setStep] = useState('menu');
            const [cart, setCart] = useState([]);
            const [customerName, setCustomerName] = useState('');
            const [pickupTime, setPickupTime] = useState('11:00');
            const [orderConfirmed, setOrderConfirmed] = useState(null);
            const [currentMenu, setCurrentMenu] = useState([]);
            const [isLoading, setIsLoading] = useState(true);

            const currentDay = manualDay !== null ? manualDay : new Date().getDay();
            const dayNames = ['NEDĚLE', 'PONDĚLÍ', 'ÚTERÝ', 'STŘEDA', 'ČTVRTEK', 'PÁTEK', 'SOBOTA'];

            useEffect(() => {
                setIsLoading(true);
                setTimeout(() => {
                    const menu = DB.getMenu(manualDay).filter(item => item.available);
                    setCurrentMenu(menu);
                    setIsLoading(false);
                }, 300);
            }, [manualDay]);

            const menu = currentMenu;

            const addToCart = (item) => {
                const existing = cart.find(c => c.id === item.id);
                if (existing) {
                    setCart(cart.map(c => c.id === item.id ? { ...c, quantity: c.quantity + 1 } : c));
                } else {
                    setCart([...cart, { ...item, quantity: 1 }]);
                }
            };

            const removeFromCart = (itemId) => {
                const existing = cart.find(c => c.id === itemId);
                if (existing.quantity > 1) {
                    setCart(cart.map(c => c.id === itemId ? { ...c, quantity: c.quantity - 1 } : c));
                } else {
                    setCart(cart.filter(c => c.id !== itemId));
                }
            };

            const totalPrice = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);

            const submitOrder = async () => {
                if (!customerName.trim()) {
                    alert('Prosím vyplň své jméno');
                    return;
                }
                if (cart.length === 0) {
                    alert('Košík je prázdný');
                    return;
                }

                const today = new Date().getDay();
                if (manualDay !== null && manualDay !== today) {
                    alert('Nelze objednat jídlo z jiného dne! Prosím klikni na AUTO pro dnešní menu.');
                    return;
                }

                const order = {
                    customerName: customerName.trim(),
                    items: cart,
                    pickupTime,
                    totalPrice,
                    status: 'pending',
                    createdAt: new Date().toISOString(),
                    pin: Math.floor(1000 + Math.random() * 9000)
                };

                try {
                    await DB.saveOrder(order);
                    setOrderConfirmed(order);
                    setCart([]);
                    setCustomerName('');
                    setStep('confirm');
                } catch (error) {
                    alert('Chyba při odesílání objednávky. Zkuste to znovu.');
                    console.error(error);
                }
            };

            // Confirmation Screen
            if (step === 'confirm' && orderConfirmed) {
                return (
                    <div style={{ minHeight: '100vh', background: 'var(--cream)' }}>
                        <div style={{ 
                            background: 'var(--white)', 
                            borderBottom: '2px solid var(--gold)',
                            padding: '60px 24px',
                            textAlign: 'center'
                        }}>
                            <div className="confirm-check animate-fadeInScale">
                                <svg viewBox="0 0 24 24" fill="none">
                                    <path d="M5 13l4 4L19 7" strokeLinecap="round" strokeLinejoin="round"/>
                                </svg>
                            </div>
                            <h1 style={{ 
                                fontFamily: "'Cormorant Garamond', serif",
                                fontSize: '24px',
                                fontWeight: '500',
                                color: 'var(--gold)',
                                letterSpacing: '6px',
                                marginBottom: '8px'
                            }} className="animate-fadeInUp stagger-1">
                                OBJEDNÁVKA PŘIJATA
                            </h1>
                            <p style={{ 
                                fontSize: '12px',
                                fontWeight: '300',
                                color: 'var(--gold)',
                                opacity: 0.7,
                                letterSpacing: '2px'
                            }} className="animate-fadeInUp stagger-2">
                                Vaše jídlo bude připraveno
                            </p>
                        </div>

                        <div style={{ padding: '32px 20px' }}>
                            <div className="card animate-fadeInUp stagger-3" style={{ padding: '40px 24px' }}>
                                <div style={{ textAlign: 'center', marginBottom: '40px', paddingBottom: '32px', borderBottom: '1px solid rgba(201, 165, 90, 0.2)' }}>
                                    <p style={{ 
                                        fontSize: '11px', 
                                        fontWeight: '500', 
                                        letterSpacing: '3px', 
                                        color: 'var(--gold)',
                                        marginBottom: '16px'
                                    }}>VÁŠ PIN KÓD</p>
                                    <div className="confirm-pin">{orderConfirmed.pin}</div>
                                    <p style={{ 
                                        fontSize: '11px', 
                                        fontWeight: '300', 
                                        color: 'var(--gold)',
                                        opacity: 0.6,
                                        marginTop: '16px'
                                    }}>Předložte tento kód při vyzvednutí</p>
                                </div>

                                <div style={{ marginBottom: '32px' }}>
                                    {[
                                        { label: 'Jméno', value: orderConfirmed.customerName },
                                        { label: 'Čas vyzvednutí', value: orderConfirmed.pickupTime }
                                    ].map((item, idx) => (
                                        <div key={idx} style={{ 
                                            display: 'flex', 
                                            justifyContent: 'space-between',
                                            padding: '16px 0',
                                            borderBottom: '1px solid rgba(201, 165, 90, 0.1)'
                                        }}>
                                            <span style={{ fontSize: '13px', fontWeight: '300', color: '#666' }}>{item.label}</span>
                                            <span style={{ fontSize: '14px', fontWeight: '500', color: 'var(--charcoal)' }}>{item.value}</span>
                                        </div>
                                    ))}
                                    <div style={{ 
                                        display: 'flex', 
                                        justifyContent: 'space-between',
                                        alignItems: 'center',
                                        padding: '24px 0'
                                    }}>
                                        <span style={{ fontSize: '13px', fontWeight: '500', color: 'var(--gold)', letterSpacing: '1px' }}>K ÚHRADĚ</span>
                                        <span className="price-tag" style={{ fontSize: '36px' }}>{orderConfirmed.totalPrice}</span>
                                    </div>
                                </div>

                                <Ornament />

                                <div style={{ paddingTop: '24px' }}>
                                    <p style={{ 
                                        fontSize: '11px', 
                                        fontWeight: '500', 
                                        letterSpacing: '2px', 
                                        color: 'var(--gold)',
                                        marginBottom: '16px'
                                    }}>POLOŽKY</p>
                                    {orderConfirmed.items.map(item => (
                                        <div key={item.id} style={{ 
                                            display: 'flex', 
                                            justifyContent: 'space-between',
                                            padding: '12px 0'
                                        }}>
                                            <span style={{ fontSize: '13px', fontWeight: '300', color: '#666' }}>
                                                {item.quantity}× {item.name}
                                            </span>
                                            <span style={{ fontSize: '13px', fontWeight: '500', color: 'var(--gold)' }}>
                                                {item.price * item.quantity} Kč
                                            </span>
                                        </div>
                                    ))}
                                </div>
                            </div>

                            <button
                                onClick={() => {
                                    setStep('menu');
                                    setOrderConfirmed(null);
                                }}
                                className="btn-gold animate-fadeInUp stagger-4"
                                style={{ width: '100%', marginTop: '24px' }}
                            >
                                ZPĚT DO MENU
                            </button>
                        </div>
                    </div>
                );
            }

            // Main Menu View
            return (
                <div style={{ paddingBottom: cart.length > 0 ? '380px' : '100px' }}>
                    {/* Header */}
                    <header className="header-glass" style={{ 
                        position: 'sticky', 
                        top: 0, 
                        zIndex: 50,
                        padding: '24px 20px'
                    }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '20px' }}>
                            <div className="animate-fadeInUp">
                                <h1 style={{ 
                                    fontFamily: "'Cormorant Garamond', serif",
                                    fontSize: '36px',
                                    fontWeight: '600',
                                    color: 'var(--gold)',
                                    letterSpacing: '10px',
                                    lineHeight: 1
                                }}>
                                    PALATINO
                                </h1>
                                <p style={{ 
                                    fontSize: '10px',
                                    fontWeight: '400',
                                    color: 'var(--gold)',
                                    letterSpacing: '4px',
                                    marginTop: '8px',
                                    opacity: 0.7
                                }}>
                                    KANTÝNA • {dayNames[currentDay]}
                                </p>
                            </div>
                            <button onClick={onAdminClick} className="btn-outline animate-fadeInUp stagger-1">
                                ADMIN
                            </button>
                        </div>
                        
                        {/* Day Selector */}
                        <div style={{ display: 'flex', gap: '8px', overflowX: 'auto', paddingBottom: '4px' }} className="animate-fadeInUp stagger-2">
                            {[1, 2, 3, 4, 5].map(day => (
                                <button
                                    key={day}
                                    onClick={() => setManualDay(day)}
                                    className={`day-pill ${currentDay === day ? 'active' : ''}`}
                                >
                                    {['', 'PO', 'ÚT', 'ST', 'ČT', 'PÁ'][day]}
                                </button>
                            ))}
                            <button
                                onClick={() => setManualDay(null)}
                                className={`day-pill ${manualDay === null ? 'active' : ''}`}
                            >
                                AUTO
                            </button>
                        </div>
                    </header>

                    {/* Menu Content */}
                    <main style={{ padding: '0 20px' }}>
                        {isLoading ? (
                            <div style={{ padding: '40px 0' }}>
                                {[1, 2, 3].map(i => (
                                    <div key={i} className="card shimmer" style={{ height: '120px', marginBottom: '16px' }} />
                                ))}
                            </div>
                        ) : menu.length === 0 || (menu.length === 1 && !menu[0].available) ? (
                            /* Empty menu - Weekend or no items */
                            <div style={{ 
                                display: 'flex', 
                                flexDirection: 'column', 
                                alignItems: 'center', 
                                justifyContent: 'center',
                                minHeight: '60vh',
                                textAlign: 'center',
                                padding: '40px 20px'
                            }}>
                                <div style={{
                                    width: '80px',
                                    height: '80px',
                                    border: '2px solid var(--gold)',
                                    borderRadius: '50%',
                                    display: 'flex',
                                    alignItems: 'center',
                                    justifyContent: 'center',
                                    marginBottom: '32px',
                                    opacity: 0.6
                                }}>
                                    <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="var(--gold)" strokeWidth="1.5">
                                        <path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" strokeLinecap="round" strokeLinejoin="round"/>
                                    </svg>
                                </div>
                                <h2 style={{
                                    fontFamily: "'Cormorant Garamond', serif",
                                    fontSize: '28px',
                                    fontWeight: '500',
                                    color: 'var(--gold)',
                                    letterSpacing: '4px',
                                    marginBottom: '16px'
                                }}>
                                    DNES ZAVŘENO
                                </h2>
                                <p style={{
                                    fontSize: '14px',
                                    fontWeight: '300',
                                    color: '#999',
                                    maxWidth: '280px',
                                    lineHeight: 1.6
                                }}>
                                    O víkendu polední menu nenabízíme. Těšíme se na vás v pondělí!
                                </p>
                            </div>
                        ) : (
                            <>
                                {['Polévka', 'Hlavní jídlo', 'Příloha', 'Dezert'].map((category, catIdx) => {
                                    const items = menu.filter(item => item.category === category);
                                    if (items.length === 0) return null;

                                    return (
                                        <section key={category}>
                                            <div className="category-header">
                                                <h2 className={`category-title animate-fadeInUp`} style={{ animationDelay: `${catIdx * 0.1}s` }}>
                                                    {category}
                                                </h2>
                                            </div>
                                            
                                            <div style={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>
                                                {items.map((item, idx) => {
                                                    const inCart = cart.find(c => c.id === item.id);
                                                    return (
                                                        <div 
                                                            key={item.id} 
                                                            className="card animate-fadeInUp"
                                                            style={{ 
                                                                padding: '24px',
                                                                animationDelay: `${(catIdx * 0.1) + (idx * 0.05)}s`
                                                            }}
                                                        >
                                                            <div style={{ marginBottom: '20px' }}>
                                                                <h3 style={{ 
                                                                    fontFamily: "'Cormorant Garamond', serif",
                                                                    fontSize: '20px',
                                                                    fontWeight: '500',
                                                                    color: 'var(--charcoal)',
                                                                    lineHeight: 1.4,
                                                                    marginBottom: '12px'
                                                                }}>
                                                                    {item.name}
                                                                </h3>
                                                                <div className="price-tag">{item.price}</div>
                                                            </div>
                                                            
                                                            {inCart ? (
                                                                <div className="qty-controls">
                                                                    <button onClick={() => removeFromCart(item.id)} className="qty-btn">−</button>
                                                                    <span style={{ 
                                                                        fontSize: '18px', 
                                                                        fontWeight: '500', 
                                                                        color: 'var(--gold)' 
                                                                    }}>{inCart.quantity}</span>
                                                                    <button onClick={() => addToCart(item)} className="qty-btn">+</button>
                                                                </div>
                                                            ) : (
                                                                <button onClick={() => addToCart(item)} className="btn-gold" style={{ width: '100%' }}>
                                                                    PŘIDAT
                                                                </button>
                                                            )}
                                                        </div>
                                                    );
                                                })}
                                            </div>
                                        </section>
                                    );
                                })}
                            </>
                        )}
                    </main>

                    {/* Cart Panel */}
                    {cart.length > 0 && (
                        <div className="cart-panel">
                            <div style={{ padding: '28px 20px' }}>
                                <div style={{ 
                                    display: 'flex', 
                                    justifyContent: 'space-between', 
                                    alignItems: 'center',
                                    marginBottom: '20px',
                                    paddingBottom: '16px',
                                    borderBottom: '1px solid rgba(201, 165, 90, 0.2)'
                                }}>
                                    <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                                        <span style={{ 
                                            fontSize: '12px', 
                                            fontWeight: '500', 
                                            letterSpacing: '2px',
                                            color: 'var(--gold)'
                                        }}>VÁŠ KOŠÍK</span>
                                        <span className="counter-badge">{totalItems}</span>
                                    </div>
                                    <button
                                        onClick={() => setCart([])}
                                        style={{ 
                                            background: 'none',
                                            border: 'none',
                                            fontSize: '11px',
                                            fontWeight: '400',
                                            color: '#999',
                                            textDecoration: 'underline',
                                            cursor: 'pointer'
                                        }}
                                    >
                                        Zrušit vše
                                    </button>
                                </div>

                                <div style={{ marginBottom: '16px' }}>
                                    <label style={{ 
                                        display: 'block',
                                        fontSize: '10px',
                                        fontWeight: '500',
                                        letterSpacing: '2px',
                                        color: 'var(--gold)',
                                        marginBottom: '8px'
                                    }}>JMÉNO</label>
                                    <input
                                        type="text"
                                        value={customerName}
                                        onChange={(e) => setCustomerName(e.target.value)}
                                        placeholder="Zadej své jméno"
                                        className="input-elegant"
                                    />
                                </div>

                                <div style={{ marginBottom: '20px' }}>
                                    <label style={{ 
                                        display: 'block',
                                        fontSize: '10px',
                                        fontWeight: '500',
                                        letterSpacing: '2px',
                                        color: 'var(--gold)',
                                        marginBottom: '8px'
                                    }}>ČAS VYZVEDNUTÍ</label>
                                    <select
                                        value={pickupTime}
                                        onChange={(e) => setPickupTime(e.target.value)}
                                        className="input-elegant"
                                        style={{ cursor: 'pointer' }}
                                    >
                                        {['10:00', '10:15', '10:30', '10:45', '11:00', '11:15', '11:30', '11:45',
                                          '12:00', '12:15', '12:30', '12:45', '13:00', '13:15', '13:30', '13:45',
                                          '14:00', '14:15', '14:30', '14:45', '15:00'].map(time => (
                                            <option key={time} value={time}>{time}</option>
                                        ))}
                                    </select>
                                </div>

                                <div style={{ 
                                    display: 'flex', 
                                    justifyContent: 'space-between', 
                                    alignItems: 'center',
                                    marginBottom: '20px',
                                    paddingTop: '16px',
                                    borderTop: '1px solid var(--gold)'
                                }}>
                                    <span style={{ 
                                        fontSize: '12px', 
                                        fontWeight: '500', 
                                        letterSpacing: '2px',
                                        color: 'var(--gold)'
                                    }}>CELKEM</span>
                                    <span className="price-tag" style={{ fontSize: '32px' }}>{totalPrice}</span>
                                </div>

                                <button onClick={submitOrder} className="btn-gold" style={{ width: '100%' }}>
                                    OBJEDNAT
                                </button>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        // Admin View
        function AdminView({ isAuth, onAuth, onBack }) {
            const [password, setPassword] = useState('');
            const [activeTab, setActiveTab] = useState('orders');
            const [orders, setOrders] = useState([]);
            const [menu, setMenu] = useState([]);
            const prevPendingRef = useRef(0);
            const audioCtxRef = useRef(null);

            const playBeep = () => {
                try {
                    const AudioCtx = window.AudioContext || window.webkitAudioContext;
                    if (!AudioCtx) return;
                    const ctx = audioCtxRef.current || new AudioCtx();
                    audioCtxRef.current = ctx;
                    const osc = ctx.createOscillator();
                    const gain = ctx.createGain();
                    osc.type = 'sine';
                    osc.frequency.value = 880;
                    gain.gain.value = 0.05;
                    osc.connect(gain).connect(ctx.destination);
                    const now = ctx.currentTime;
                    osc.start(now);
                    osc.stop(now + 0.15);
                } catch (e) {
                    console.warn('Beep failed:', e);
                }
            };

            useEffect(() => {
                if (isAuth) {
                    DB.getOrders((orders) => setOrders(orders));
                    setMenu(DB.getMenu());
                }
            }, [isAuth]);

            // Alert on new pending orders
            useEffect(() => {
                if (!isAuth) return;
                const today = new Date().toDateString();
                const todayPending = orders.filter(o => {
                    const orderDate = new Date(o.createdAt).toDateString();
                    return orderDate === today && o.status === 'pending';
                }).length;
                if (todayPending > prevPendingRef.current) {
                    playBeep();
                }
                prevPendingRef.current = todayPending;
            }, [orders, isAuth]);

            const handleLogin = () => {
                if (password === 'Kx9mPn2vLq4wRt8zFh6jYb3sGd7cNm5p') {
                    onAuth(true);
                } else {
                    alert('Špatné heslo!');
                }
            };

            const markAsCompleted = async (orderId) => {
                await DB.updateOrder(orderId, { status: 'completed' });
            };

            const deleteOrder = async (orderId) => {
                if (confirm('Opravdu smazat tuto objednávku?')) {
                    await DB.deleteOrder(orderId);
                }
            };

            if (!isAuth) {
                return (
                    <div style={{ 
                        minHeight: '100vh',
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        padding: '20px',
                        background: 'linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)'
                    }}>
                        <div className="card animate-fadeInScale" style={{ 
                            width: '100%',
                            maxWidth: '400px',
                            padding: '48px 32px'
                        }}>
                            <h2 style={{ 
                                fontFamily: "'Cormorant Garamond', serif",
                                fontSize: '28px',
                                fontWeight: '500',
                                textAlign: 'center',
                                color: 'var(--gold)',
                                letterSpacing: '4px',
                                marginBottom: '32px'
                            }}>ADMIN</h2>
                            
                            <Ornament />
                            
                            <input
                                type="password"
                                value={password}
                                onChange={(e) => setPassword(e.target.value)}
                                onKeyPress={(e) => e.key === 'Enter' && handleLogin()}
                                placeholder="Zadej heslo"
                                className="input-elegant"
                                style={{ marginTop: '24px', marginBottom: '16px' }}
                            />
                            <button onClick={handleLogin} className="btn-gold" style={{ width: '100%', marginBottom: '12px' }}>
                                PŘIHLÁSIT
                            </button>
                            <button onClick={onBack} className="btn-outline" style={{ width: '100%' }}>
                                ZPĚT
                            </button>
                        </div>
                    </div>
                );
            }

            // Už máme z DB jen dnešní objednávky (dotaz where('date','==', today)),
            // není potřeba znovu filtrovat podle createdAt (může být Firestore Timestamp).
            const todayOrders = orders;

            const pendingOrders = todayOrders.filter(o => o.status === 'pending');
            const completedOrders = todayOrders.filter(o => o.status === 'completed');

            return (
                <div style={{ minHeight: '100vh', background: 'var(--cream)' }}>
                    {/* Admin Header */}
                    <header style={{ 
                        background: 'linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)',
                        padding: '24px 20px',
                        position: 'sticky',
                        top: 0,
                        zIndex: 50
                    }}>
                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>
                            <h1 style={{ 
                                fontFamily: "'Cormorant Garamond', serif",
                                fontSize: '24px',
                                fontWeight: '500',
                                color: 'var(--gold)',
                                letterSpacing: '4px'
                            }}>ADMIN PANEL</h1>
                            <button
                                onClick={() => { onAuth(false); onBack(); }}
                                style={{
                                    background: 'rgba(255,255,255,0.1)',
                                    border: '1px solid rgba(255,255,255,0.2)',
                                    color: '#fff',
                                    padding: '10px 20px',
                                    fontSize: '11px',
                                    letterSpacing: '1px',
                                    cursor: 'pointer'
                                }}
                            >
                                ODHLÁSIT
                            </button>
                        </div>
                        
                        <div style={{ display: 'flex', gap: '8px' }}>
                            {['orders', 'menu'].map(tab => (
                                <button
                                    key={tab}
                                    onClick={() => setActiveTab(tab)}
                                    style={{
                                        flex: 1,
                                        padding: '12px',
                                        background: activeTab === tab ? 'var(--gold)' : 'rgba(255,255,255,0.1)',
                                        color: activeTab === tab ? '#1a1a2e' : '#fff',
                                        border: 'none',
                                        fontSize: '12px',
                                        fontWeight: '500',
                                        letterSpacing: '1px',
                                        cursor: 'pointer'
                                    }}
                                >
                                    {tab === 'orders' ? `OBJEDNÁVKY (${pendingOrders.length})` : 'MENU'}
                                </button>
                            ))}
                        </div>
                    </header>

                    <main style={{ padding: '20px' }}>
                        {activeTab === 'orders' ? (
                            <>
                                {pendingOrders.length === 0 ? (
                                    <div style={{ textAlign: 'center', padding: '60px 20px' }}>
                                        <div style={{ fontSize: '64px', marginBottom: '16px', opacity: 0.3 }}>📋</div>
                                        <p style={{ color: '#999', fontSize: '14px' }}>Žádné čekající objednávky</p>
                                    </div>
                                ) : (
                                    <>
                                        <h2 style={{ 
                                            fontSize: '14px',
                                            fontWeight: '500',
                                            letterSpacing: '2px',
                                            color: 'var(--gold)',
                                            marginBottom: '16px'
                                        }}>ČEKAJÍCÍ</h2>
                                        
                                        <div style={{ display: 'flex', flexDirection: 'column', gap: '16px', marginBottom: '32px' }}>
                                            {pendingOrders.map((order, idx) => (
                                                <div 
                                                    key={order.id} 
                                                    className="card animate-fadeInUp"
                                                    style={{ 
                                                        padding: '24px',
                                                        borderLeft: '4px solid #f59e0b',
                                                        animationDelay: `${idx * 0.1}s`
                                                    }}
                                                >
                                                    <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '16px' }}>
                                                        <div>
                                                            <div style={{ 
                                                                fontFamily: "'Cormorant Garamond', serif",
                                                                fontSize: '36px',
                                                                fontWeight: '500',
                                                                color: '#f59e0b'
                                                            }}>{order.pin}</div>
                                                            <div style={{ fontWeight: '500', fontSize: '16px' }}>{order.customerName}</div>
                                                            <div style={{ fontSize: '13px', color: '#666' }}>Vyzvednutí: {order.pickupTime}</div>
                                                        </div>
                                                        <div style={{ textAlign: 'right' }}>
                                                            <div className="price-tag">{order.totalPrice}</div>
                                                            <div style={{ fontSize: '11px', color: '#999', marginTop: '4px' }}>
                                                                {new Date(order.createdAt).toLocaleTimeString('cs-CZ', { hour: '2-digit', minute: '2-digit' })}
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                    <div style={{ borderTop: '1px solid rgba(0,0,0,0.1)', paddingTop: '12px', marginBottom: '16px' }}>
                                                        {order.items.map(item => (
                                                            <div key={item.id} style={{ 
                                                                display: 'flex', 
                                                                justifyContent: 'space-between',
                                                                fontSize: '13px',
                                                                padding: '4px 0'
                                                            }}>
                                                                <span style={{ color: '#666' }}>{item.quantity}× {item.name}</span>
                                                                <span style={{ color: 'var(--gold)' }}>{item.price * item.quantity} Kč</span>
                                                            </div>
                                                        ))}
                                                    </div>
                                                    
                                                    <div style={{ display: 'flex', gap: '8px' }}>
                                                        <button
                                                            onClick={() => markAsCompleted(order.id)}
                                                            style={{
                                                                flex: 1,
                                                                padding: '14px',
                                                                background: '#10b981',
                                                                color: '#fff',
                                                                border: 'none',
                                                                fontSize: '12px',
                                                                fontWeight: '500',
                                                                letterSpacing: '1px',
                                                                cursor: 'pointer'
                                                            }}
                                                        >
                                                            ✓ VYZVEDNUTO
                                                        </button>
                                                        <button
                                                            onClick={() => deleteOrder(order.id)}
                                                            style={{
                                                                padding: '14px 20px',
                                                                background: '#ef4444',
                                                                color: '#fff',
                                                                border: 'none',
                                                                fontSize: '14px',
                                                                cursor: 'pointer'
                                                            }}
                                                        >
                                                            ×
                                                        </button>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </>
                                )}

                                {completedOrders.length > 0 && (
                                    <>
                                        <h2 style={{ 
                                            fontSize: '14px',
                                            fontWeight: '500',
                                            letterSpacing: '2px',
                                            color: '#999',
                                            marginBottom: '16px'
                                        }}>DOKONČENÉ DNES</h2>
                                        
                                        <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
                                            {completedOrders.map(order => (
                                                <div 
                                                    key={order.id} 
                                                    style={{ 
                                                        background: 'rgba(0,0,0,0.02)',
                                                        padding: '16px',
                                                        border: '1px solid rgba(0,0,0,0.05)',
                                                        opacity: 0.6
                                                    }}
                                                >
                                                    <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                        <div>
                                                            <div style={{ fontWeight: '500' }}>{order.customerName}</div>
                                                            <div style={{ fontSize: '12px', color: '#666' }}>{order.pickupTime}</div>
                                                        </div>
                                                        <div style={{ textAlign: 'right' }}>
                                                            <div style={{ fontWeight: '500' }}>{order.totalPrice} Kč</div>
                                                            <div style={{ fontSize: '11px', color: '#10b981' }}>✓ Vyzvednuto</div>
                                                        </div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </>
                                )}
                            </>
                        ) : (
                            <>
                                <h2 style={{ 
                                    fontSize: '14px',
                                    fontWeight: '500',
                                    letterSpacing: '2px',
                                    color: 'var(--gold)',
                                    marginBottom: '16px'
                                }}>DNEŠNÍ MENU</h2>
                                
                                <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
                                    {menu.map((item, idx) => (
                                        <div 
                                            key={item.id} 
                                            className="card animate-fadeInUp"
                                            style={{ 
                                                padding: '16px 20px',
                                                animationDelay: `${idx * 0.05}s`
                                            }}
                                        >
                                            <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
                                                <div>
                                                    <div style={{ 
                                                        fontSize: '10px',
                                                        fontWeight: '500',
                                                        color: 'var(--gold)',
                                                        letterSpacing: '1px',
                                                        marginBottom: '4px'
                                                    }}>{item.category.toUpperCase()}</div>
                                                    <div style={{ fontWeight: '500' }}>{item.name}</div>
                                                </div>
                                                <div className="price-tag" style={{ fontSize: '20px' }}>{item.price}</div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </>
                        )}
                    </main>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
